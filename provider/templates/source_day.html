{% extends 'base.html' %}

{% block title %}
    Summary for {{ current_date|date:'d F' }} in {{ source_name }}
{% endblock %}


{% block content %}
    <h1><strong>{{ source_name }}</strong></h1>
    <h3> These are the stories fetched on {{ current_date|date:'F d, Y' }}.</h3>

    {% if error_count %}
    <h4>However, be aware that there aree <b>{{ error_count }}</b> pending error{{ error_count|pluralize }} that day.
    </h4>
    {% endif %}

    <div id="span-15">

            {% if prev_day %}
                <a href='/source/{{ source_name }}/{{ prev_day }}'>&laquo; Previous day</a>
            {% else %}
                <span class="quiet"><strong>&laquo; No previous day</strong></span>
            {% endif %}

        <span style="float:right" >
            {% if next_day %}
                <a href='/source/{{ source_name }}/{{ next_day }}'>Next day &raquo;</a>
            {% else %}
                <span class="quiet"><strong> No next day &raquo;</strong></span>
            {% endif %}
        </span>
    </div>

    <br/>

    
    {% for batch_time,articles,batch_metainfos in articles_and_metainfos %}

        <div class="box">
            <span class="quiet">{{ batch_time }}</span><br/><br/>

            {% if articles %}
                <ul>
                {% for article in articles %}
                    <li>{{ article.title}} </li>
                {% endfor %}
                </ul>

                <br/>
                <a href='/source/{{ source_name }}/{{ current_date|date:'Y-m-d' }}/{{ batch_time }}/articles'>Would you like to know more?</a>

            {% else %}
                Nothing new was found at that time.
            {% endif %}
            <br/><br/>

            {% if batch_metainfos.reprocessed_article_count  %}
                <strong>{{ batch_metainfos.reprocessed_article_count }}</strong> of these articles
                were processed with the error handling script.
            {% endif %}

            {% if batch_metainfos.pending_error_count  %}
                This batch has <a href="/source/{{ source_name }}/{{ current_date|date:'Y-m-d' }}/{{ batch_time }}/errors">
                <strong>{{ batch_metainfos.pending_error_count}}</strong> pending error{{ batch_metainfos.pending_error_count|pluralize }}.</a>
            {% endif %}
        </div>

    {% endfor %}

    <br/>
    <div id="span-15">

            {% if prev_day %}
                <a href='/source/{{ source_name }}/{{ prev_day }}'>&laquo; Previous day</a>
            {% else %}
                <span class="quiet"><strong>&laquo; No previous day</strong></span>
            {% endif %}

        <span style="float:right" >
            {% if next_day %}
                <a href='/source/{{ source_name }}/{{ next_day }}'>Next day &raquo;</a>
            {% else %}
                <span class="quiet"><strong> No next day &raquo;</strong></span>
            {% endif %}
        </span>
    </div>


{% endblock %}